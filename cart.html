<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Cart - UTU Hardware</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .cart-section, .orders-section {
      max-width: 500px;
      margin: 0 auto;
      padding: 1.5rem 1rem 5rem 1rem;
    }
    .cart-list, .orders-list {
      list-style: none;
      padding: 0;
      margin: 0 0 1.5rem 0;
    }
    .cart-item, .order-item {
      display: flex;
      align-items: center;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(34,34,34,0.08);
      margin-bottom: 1rem;
      padding: 0.7rem 1rem;
      gap: 1rem;
    }
    .cart-item img, .order-item img {
      width: 56px;
      height: 56px;
      object-fit: cover;
      border-radius: 8px;
      background: #f5f5f5;
    }
    .cart-item-details, .order-item-details {
      flex: 1;
    }
    .cart-item-title, .order-item-title {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 0.2rem;
    }
    .cart-item-remove {
      background: #FFD600;
      border: none;
      border-radius: 5px;
      color: #111;
      font-weight: 700;
      padding: 0.4rem 0.8rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .cart-item-remove:hover {
      background: #d32f2f;
      color: #fff;
    }
    .place-order-btn {
      width: 100%;
      background: linear-gradient(90deg, #FFD600 60%, #fffbe6 100%);
      color: #111;
      font-weight: 700;
      font-size: 1.1rem;
      border: none;
      border-radius: 8px;
      padding: 0.9rem 0;
      margin-bottom: 1.5rem;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(34,34,34,0.08);
      transition: background 0.2s, color 0.2s;
    }
    .place-order-btn:active {
      background: #FFD600;
      color: #222;
    }
    .orders-section h2 {
      margin-top: 2rem;
      margin-bottom: 1rem;
      font-size: 1.2rem;
      color: #FFD600;
    }
    .order-date {
      font-size: 0.95rem;
      color: #888;
      margin-bottom: 0.2rem;
    }
    @media (max-width: 600px) {
      .cart-section, .orders-section {
        padding: 1rem 0.2rem 5rem 0.2rem;
      }
      .cart-item, .order-item {
        padding: 0.6rem 0.5rem;
        gap: 0.5rem;
      }
      .cart-item img, .order-item img {
        width: 44px;
        height: 44px;
      }
    }
  </style>
</head>
<body>
  <main>
    <section class="cart-section">
      <h1>Your Cart</h1>
      <ul class="cart-list" id="cartList"></ul>
      <button class="place-order-btn" id="placeOrderBtn">Place Order</button>
      <div id="cartEmptyMsg" style="display:none; color:#888; text-align:center; margin-bottom:1.5rem;">Your cart is empty.</div>
    </section>
    <section class="orders-section">
      <h2>Your Orders</h2>
      <ul class="orders-list" id="ordersList"></ul>
      <div id="ordersEmptyMsg" style="display:none; color:#888; text-align:center;">No orders yet.</div>
    </section>
  </main>
  <nav class="bottom-nav">
    <a href="index.html" class="nav-item">
      <i class="fa fa-home"></i>
      <span>Home</span>
    </a>
    <a href="products.html" class="nav-item">
      <i class="fa fa-th-large"></i>
      <span>Products</span>
    </a>
    <a href="cart.html" class="nav-item active">
      <i class="fa fa-shopping-cart"></i>
      <span>Cart</span>
    </a>
  </nav>
  <script>
    // Fetch and render cart
    async function loadCart() {
      const res = await fetch('/cart');
      const cart = await res.json();
      const cartList = document.getElementById('cartList');
      cartList.innerHTML = '';
      if (!cart.length) {
        document.getElementById('cartEmptyMsg').style.display = 'block';
        document.getElementById('placeOrderBtn').style.display = 'none';
      } else {
        document.getElementById('cartEmptyMsg').style.display = 'none';
        document.getElementById('placeOrderBtn').style.display = 'block';
        cart.forEach(item => {
          const li = document.createElement('li');
          li.className = 'cart-item';
          li.innerHTML = `
            <img src="${item.image || 'images/tools.jpg'}" alt="${item.name}">
            <div class="cart-item-details">
              <div class="cart-item-title">${item.name}</div>
              <div>${item.brand ? 'Brand: ' + item.brand : ''}</div>
              <div>${item.price ? 'â‚¹' + item.price : ''}</div>
            </div>
            <button class="cart-item-remove" data-id="${item.id}">Remove</button>
          `;
          cartList.appendChild(li);
        });
      }
    }
    // Remove from cart
    document.getElementById('cartList').addEventListener('click', async (e) => {
      if (e.target.classList.contains('cart-item-remove')) {
        const id = e.target.getAttribute('data-id');
        await fetch('/cart/remove', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ productId: id })
        });
        loadCart();
      }
    });
    // Place order
    document.getElementById('placeOrderBtn').onclick = async () => {
      const res = await fetch('/order', { method: 'POST' });
      if (res.ok) {
        loadCart();
        loadOrders();
        alert('Order placed successfully!');
      } else {
        alert('Could not place order.');
      }
    };
    // Fetch and render orders
    async function loadOrders() {
      const res = await fetch('/orders');
      const orders = await res.json();
      const ordersList = document.getElementById('ordersList');
      ordersList.innerHTML = '';
      if (!orders.length) {
        document.getElementById('ordersEmptyMsg').style.display = 'block';
      } else {
        document.getElementById('ordersEmptyMsg').style.display = 'none';
        orders.reverse().forEach(order => {
          const li = document.createElement('li');
          li.className = 'order-item';
          li.innerHTML = `
            <div class="order-item-details">
              <div class="order-date">${new Date(order.date).toLocaleString()}</div>
              <div class="order-item-title">${order.items.map(i => i.name).join(', ')}</div>
              <div>${order.items.length} item(s)</div>
            </div>
          `;
          ordersList.appendChild(li);
        });
      }
    }
    // Initial load
    loadCart();
    loadOrders();
  </script>
</body>
</html> 